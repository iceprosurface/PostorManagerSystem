"use strict";function redirectControl(e){$("#"+e).find("a").each(function(e,t){var n=$(this);n.data("method")&&reloadfn.hasOwnProperty(n.data("method"))&&n.click(reloadfn[n.data("method")].bind(this,1))})}function loginOut(){var e;""!==e?$.ajax({type:"GET",url:"/api/login/loginOut",data:e,success:function(e){window.location="/login.html?respond=1"},error:function(e){alert("没有成功登出")},dataType:"json"}):window.location="/login.html?respond=1"}function loadChecked(e){e||(e=1),$.get("/api/get/getChecked",{page:e},function(e){e=JSON.parse(e),$("#OrderTable").html(""),$.each(e.orders,function(e,t){$("#OrderTable").append("<tr><td><label class='input-control checkbox small-check no-margin'><input type='checkbox' id='checkBox_"+e+"'><span class='check'></span></label></td><td>"+t.orderid+"</td><td>"+t.exporttime+"</td><td>"+t.orderinfo+"</td><td>"+t.postorid+"</td></tr>")}),iniPages(e.maxPage,e.page)})}function loadUnchecked(e){e||(e=1),$.get("/api/get/getUnchecked",{page:e},function(e){e=JSON.parse(e),$("#OrderTable").html(""),$.each(e.orders,function(e,t){var n;n="1"==t.delay?new Date(new Date(t.importtime).valueOf()+864e5):new Date(t.importtime),$("#OrderTable").append("<tr><td><label class='input-control checkbox small-check no-margin'><input type='checkbox' class='uncheck' id='checkBox_"+e+"' data-id='"+t.orderid+"'><span class='check'></span></label></td><td>"+t.orderid+"</td><td>"+t.importtime+"</td><td>"+n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate()+" "+n.toTimeString()+"</td><td>"+t.positionid+"</td><td>"+t.orderinfo+"</td><td>"+t.postorid+"</td></tr>")}),iniPages(e.maxPage,e.page)})}function loadAll(e){e||(e=1),$.get("/api/get/getAllTables",{page:e},function(e){e=JSON.parse(e),$("#OrderTable").html(""),$.each(e.orders,function(e,t){$("#OrderTable").append("<tr><td><label class='input-control checkbox small-check no-margin'><input type='checkbox' class='uncheck' id='checkBox_"+e+"' data-id='"+t.orderid+"'><span class='check'></span></label></td><td>"+t.orderid+"</td><td>"+t.importtime+"</td><td>"+t.exporttime+"</td><td>"+t.positionid+"</td><td>"+t.orderinfo+"</td><td>"+t.postorid+"</td></tr>")}),iniPages(e.maxPage,e.page)})}function respondDialog(e,t,n){var a=$(e).data("dialog");$(e).children().children()[0].innerHTML=n,a.open()}function showDialog(e){var t=$(e).data("dialog");t.open()}function closeDialog(e){var t=$(e).data("dialog");t.close()}function pushMessage(e){var t="通知|你已经选择了全部订单";$.Notify({caption:t.split("|")[0],content:t.split("|")[1],type:"success"})}function selectCheckBox(e){var t="通知|你已经选择了全部订单|你已经取消了全部订单";$.Notify({caption:t.split("|")[0],content:t.split("|")["true"==e?1:2],type:"true"==e?"info":"success"});var n=document.getElementsByClassName("uncheck");$.each(n,function(t,n){n.checked="true"==e})}function delayOrders(){var e="通知|你选择的订单已被延期处理";$.Notify({caption:e.split("|")[0],content:e.split("|")[1],type:"warning"});var t=[],n=document.getElementsByClassName("uncheck");return $.each(n,function(e,n){n.checked===!0&&t.push($(n).data("id"))}),0===t.length?!1:void $.ajax({type:"GET",url:"/api/get/delay",data:{orderlist:t},dataType:"json",success:function(e){reloadfn.turnUnreceived()}})}function msg(e){$.Notify({caption:e.split("|")[0],content:e.split("|")[1],type:"success"})}function sendMail(){}function iniPages(e,t){var n=$("#pages"),a={cont:$("#pagecont"),pages:e,skip:!0,skin:"#01a0e1",curr:t||1,groups:5,jump:function(e,t){if(!t){var a=e.curr;switch(reloadfn.nowpositon){case"Unreceived":loadUnchecked(a);break;case"All":loadAll(a);break;case"Received":loadChecked(a)}}n.html("当前：第"+e.curr+"页，总计："+e.pages+"页")}};laypage(a)}var reloadfn={nowpositon:"default",sidebarRefresh:function(e){""!==e&&$.get("/api/get/getOrderNumber",e,function(e){var t=JSON.parse(e);$("#checkedCount").text(t.checkedCount),$("#uncheckCount").text(t.uncheckedCount);var n=t.checkedCount+t.uncheckedCount;$("#allCount").text(n)})},turnUnreceived:function(e){reloadfn.nowpositon="Unreceived",$("#main").load("/tpl/UncheckedPage.html",function(){loadUnchecked(e)})},changeToConfig:function(){reloadfn.nowpositon="Config",$("#main").load("/tpl/UsrConfig.html")},turnReceived:function(e){reloadfn.nowpositon="Received",$("#main").load("/tpl/CheckedPage.html",function(){loadChecked(e)})},turnBin:function(e){reloadfn.nowpositon="Bin",$("#main").load("/tpl/UsrBin.html",loadBin)},turnAll:function(e){reloadfn.nowpositon="All",$("#main").load("/tpl/AllTable.html",function(){loadAll(e)})}},redirectctl=redirectControl("sidebar"),nowpositon="default";$(function(){$(".sidebar").on("click","li",function(){$(this).hasClass("active")||($(".sidebar li").removeClass("active"),$(this).addClass("active"))})}),$(document).ready(function(){$("#tishi").load("/api/get/usrconfig",function(){$("#carousel").carousel(),$("#mailcheck").on("click",function(){return"true"==$(this).data("issended")?!1:void $.get("/api/mail/mailcheck",{},function(e){msg("通知|重新发送成功")})})});var e;reloadfn.sidebarRefresh(e),$.ajax({type:"GET",url:"/api/get/getusrname",data:{},success:function(e){e=JSON.parse(e);var t=$("#username");t[0].innerHTML="",t.append('<span class="mif-cog"></span><span>'+e.name+"</span>")},dataType:"json"}),$(window).on("resize",function(){$(this).width()<=800?$(".sidebar").addClass("compact"):$(".sidebar").removeClass("compact")})});